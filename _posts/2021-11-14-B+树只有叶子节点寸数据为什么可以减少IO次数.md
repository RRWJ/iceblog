---
layout: post
title: B+树只有叶子结点存数据，为什么可以减少IO次数？
subtitle: bug
tags: [B+树]
comments: true
---
# 常见问题：
## B+树结构？ 
```
1.多路平衡查找树 
2.只有叶子结点存数据，减少IO次数。 
3.每次都要查到叶子结点，查找性能稳定。 
4.底层是有序双向链表，便于范围查找。
```
## 只有叶子结点存数据，为什么可以减少IO次数？
```
* 为了充分利用磁盘的顺序 IO 能力和 cache，b+ 树的一个节点大小一般等于磁盘页大小。为了避免连续的节点分裂，b+ 树节点会预留一部分空间。但在节点分裂和合并的结束后，b+ 树节点最终都要求是半满的。因此，额外的空间浪费的确存在，但可以接受。
* 如 1 中所述，一个磁盘页通常对应一个节点，但一个节点可以存储多个键值对。这里的b+树更矮胖是指因为 b+ 树非页节点只存储索引信息（搜索键和对应的页指针），而叶节点则需要存储搜索键和数据信息。相对于b树而言，在相同的页大小下，b+ 树非页节点显然可以存储更多的搜索键，也就是说 b+ 树节点的 fanout 扇出更大。b 树和 b+ 树都是平衡树，在存储相同的数据量情况下树的高度可以看作是以 fanout 为底，数据量的对数，因此 b+树的高度更低。
* 按照平衡树的原则，b+ 树和 b 树的查询都是从根节点出发，进行搜索。在不考虑缓存的情况下，访问一个节点需要进行一次 IO。对于 b 树和 b+ 树而言，最坏情况都需要访问到叶节点才能读取到数据，由于 b+ 树的高度更低，因此可以认为 b+ 树的 IO 次数更少。
```
## B+树一般有几层？（没答出来，感谢学长听完录音后帮我指导和延伸思路:）
```
一般一到三层就可以支持千万级别的数据。 
延伸：为什么呢？为什么不用四到五层支持上亿级的数据呢？ 
因为一般来说，一个单表不会支持那么多数据。 
继续延伸：怎么分表
```